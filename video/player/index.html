<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Player</title>
    <link rel="icon" href="../../assets/favicon.png" type="image/png" />
    <link href="https://unpkg.com/cloudinary-video-player@latest/dist/cld-video-player.min.css" rel="stylesheet">
    <script src="https://unpkg.com/cloudinary-video-player@latest/dist/cld-video-player.min.js"
        type="text/javascript"></script>
    <style>
        .container {
            width: 60%;
            margin: 20px auto;
        }

        h1 {
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
        }
    </style>
</head>

<body>
    <h1>Cloudinary Video Player</h1>
    <div class="container">
        <video id="example-player" class="cld-video-player cld-fluid"></video>
        <div id="events-list">
            <ul></ul>
        </div>
    </div>

</body>
<script type="text/javascript">
    // Initialize player
    var player = cloudinary.videoPlayer('example-player', {
        cloud_name: 'cloudinary-training', 
        muted: true,
        controls: true,
        transformation: { start_offset: 8, duration: 14 }
    })
    player.source('surfing').play();

    // Log events (analytics)
    var autoEventTypes = ['sourcechanged', 'timeplayed', 'percentsplayed', 'ended'];
    var manualEventTypes = ['play', 'pause', 'volumechange', 'mute', 'unmute', 'fullscreenchange', 'seek'];

    function checkTime(i) {
        return (i < 10) ? "0" + i : i;
    }
    // calc time
    function startTime() {
        var today = new Date(),
            h = checkTime(today.getHours()),
            m = checkTime(today.getMinutes()),
            s = checkTime(today.getSeconds());
        return (h + ":" + m + ":" + s);
    }

    // log events
    function updateOnEvent(eventStr, automatic) {
        console.log(eventStr)
        var list = document.querySelector('#events-list ul')
        var entry = document.createElement('li');
        entry.appendChild(document.createTextNode(eventStr));
        list.appendChild(entry);
    }




    autoEventTypes.forEach(function (eventType) {
        player.on(eventType, function (event) {
            var eventStr = startTime() + " " + eventType;
            if (event.eventData) {
                eventStr = eventStr + ": " + JSON.stringify(event.eventData)
            }
            updateOnEvent(eventStr, true);
        })
    });

    manualEventTypes.forEach(function (eventType) {
        player.on(eventType, function (event) {
            var eventStr = startTime() + " " + eventType;
            if (event.eventData) {
                eventStr = eventStr + ": " + JSON.stringify(event.eventData)
            }
            updateOnEvent(eventStr, false);
        })
    });



</script>

</html>